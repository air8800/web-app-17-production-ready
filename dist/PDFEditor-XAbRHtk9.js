import{c as fa,j as e,r as R,D as xa,p as Qt,g as Pt,X as dt,F as Ct,S as wa,a as ba,C as Ht,Z as ya,b as va,M as $t,P as Na,R as Pa,d as Ot,e as Ca,f as gt,m as $a,l as jt,h as ja,i as Sa,k as Aa,n as Ra,o as Fa}from"./main-DUpaawXr.js";import{S as St,M as Ea,C as Da,R as Wt,D as Ma,a as Ut,b as La,G as Ia,c as Xa,A as Ya,d as ka}from"./Dropdown-CyGWHJ9W.js";/**
 * @license lucide-react v0.358.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=fa("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),za=({width:N="100%",height:p="200px",className:l=""})=>e.jsx("div",{className:`thumbnail-shimmer ${l}`,style:{width:N,height:p},"aria-label":"Loading thumbnail",children:e.jsx("style",{jsx:!0,children:`
        .thumbnail-shimmer {
          position: relative;
          overflow: hidden;
          background: linear-gradient(
            90deg,
            #f0f0f0 0%,
            #f0f0f0 40%,
            #e8e8e8 50%,
            #f0f0f0 60%,
            #f0f0f0 100%
          );
          background-size: 200% 100%;
          animation: shimmer 2s ease-in-out infinite;
          border-radius: 4px;
        }

        @keyframes shimmer {
          0% {
            background-position: -200% 0;
          }
          100% {
            background-position: 200% 0;
          }
        }
      `})}),Bt=["Loading your document...","Preparing pages for editing...","Almost ready...","Setting up workspace..."],Ha=({loadingStage:N,loadedCount:p,totalPages:l})=>{const[g,P]=R.useState(0),[z,L]=R.useState(!1),E=N==="parsing"||N==="loading",v=l>0?p/l*100:0;return R.useEffect(()=>{const X=window.matchMedia("(prefers-reduced-motion: reduce)");L(X.matches);const W=H=>L(H.matches);return X.addEventListener("change",W),()=>X.removeEventListener("change",W)},[]),R.useEffect(()=>{if(!E||z)return;const X=setInterval(()=>{P(W=>(W+1)%Bt.length)},2500);return()=>clearInterval(X)},[E,z]),E?e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx("div",{className:"max-w-md w-full bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("svg",{className:"w-5 h-5 text-slate-400 loading-spinner",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-200 message-fade-in",children:Bt[g]},g),N==="loading"&&l>0&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 progress-pulse",children:[l," pages"]})]}),N==="loading"&&e.jsx("div",{className:"h-1 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-slate-400 dark:bg-slate-500 rounded-full transition-all duration-500 ease-out",style:{width:`${v}%`}})})]})]})})}):null},qt=(N,p,l)=>{const{cropArea:g,rotation:P=0,scale:z=100,offsetX:L=0,offsetY:E=0}=l||{};let v={x:0,y:0,width:N.width,height:N.height};g&&(v={x:g.x*N.width,y:g.y*N.height,width:g.width*N.width,height:g.height*N.height});const X=(P%360+360)%360,W=X===90||X===270;let H;if(P!==0)if(W){const Ee=p.width/v.height,Se=p.height/v.width;H=Math.min(Ee,Se)*.9}else{const Ee=p.width/v.width,Se=p.height/v.height;H=Math.min(Ee,Se)*.9}else H=1;const J=z/100,Y=H*J,Q=v.width*Y,V=v.height*Y,ee=-Q/2,oe=-V/2,he=-P*Math.PI/180,ie=Math.cos(he),ce=Math.sin(he),re=-Q/2,we=-V/2,ae=re*ie-we*ce,ke=re*ce+we*ie,ue=p.width/2,Ze=p.height/2,_e=ue+ae+L,M=Ze+ke-E;return{sourceRect:v,scaleToFit:H,finalScale:Y,drawWidth:Q,drawHeight:V,drawX:ee,drawY:oe,pdfDrawX:_e,pdfDrawY:M,pdfRotation:-P,offsetX:L,offsetY:E}},Oa=(N,p,l,g,P)=>{const z=(P%360+360)%360;if(z===90||z===270){const E=l/p,v=g/N;return Math.min(E,v)*.9}else{const E=l/N,v=g/p;return Math.min(E,v)*.9}};function Wa(N,p){const l=N/p;return Math.abs(l-1)<.05?"square":N>p?"landscape":"portrait"}function Ua(N,p){return{width:N,height:p,orientation:Wa(N,p)}}const At=async(N,p,l,g={})=>{const{scale:P=1,skipThumbnail:z=!1,skipClone:L=!1,thumbnailScale:E=1,thumbnailQuality:v=.6}=g;try{const X=performance.now(),W=await N.getPage(p);l==null||l.step(`getPage(${(performance.now()-X).toFixed(0)}ms)`);const H=performance.now(),J=W.getViewport({scale:P});l==null||l.step(`getViewport(${(performance.now()-H).toFixed(0)}ms)`);const Y=performance.now(),Q=document.createElement("canvas"),V=Q.getContext("2d",{alpha:!1,willReadFrequently:!1});if(!V)return console.error(`Failed to get 2d context for page ${p}`),null;Q.height=J.height,Q.width=J.width,V.fillStyle="white",V.fillRect(0,0,Q.width,Q.height),V.imageSmoothingEnabled=!0,V.imageSmoothingQuality="high",l==null||l.step(`canvas-setup(${(performance.now()-Y).toFixed(0)}ms)`);const ee=performance.now();await W.render({canvasContext:V,viewport:J}).promise,l==null||l.step(`page.render(${(performance.now()-ee).toFixed(0)}ms)`);let oe="";if(z)l==null||l.step("thumbnail(skipped)");else{const re=performance.now();oe=Ye(Q,E,v),l==null||l.step(`thumbnail(${(performance.now()-re).toFixed(0)}ms)`)}const he=performance.now();let ie;if(L)ie=Q,l==null||l.step("clone(skipped)");else{ie=document.createElement("canvas"),ie.width=Q.width,ie.height=Q.height;const re=ie.getContext("2d",{alpha:!1});re&&re.drawImage(Q,0,0),l==null||l.step(`clone(${(performance.now()-he).toFixed(0)}ms)`)}const ce=Ua(J.width,J.height);return{pageNumber:p,canvas:Q,originalCanvas:ie,pristineOriginal:ie,width:J.width,height:J.height,orientation:ce.orientation,thumbnail:oe,edited:!1,editHistory:{rotation:0,scale:100,offsetX:0,offsetY:0,cropArea:null}}}catch(X){return console.error(`‚ùå Error rendering page ${p}:`,X),null}},Ye=(N,p=.5,l=.6)=>{const g=document.createElement("canvas");g.width=N.width*p,g.height=N.height*p;const P=g.getContext("2d",{alpha:!1,willReadFrequently:!0});return P?(P.fillStyle="white",P.fillRect(0,0,g.width,g.height),P.imageSmoothingEnabled=!0,P.imageSmoothingQuality="high",P.drawImage(N,0,0,g.width,g.height),g.toDataURL("image/jpeg",l)):N.toDataURL("image/jpeg",l)},Gt=async(N,p,l)=>{try{const{settings:g,userScale:P,currentPageSize:z,cropInfo:L}=p,E=l(z),v=document.createElement("canvas"),X=v.getContext("2d",{alpha:!1,willReadFrequently:!1});if(!X)return console.error(`Failed to get 2d context for page ${N.pageNumber}`),N;X.imageSmoothingEnabled=!0,X.imageSmoothingQuality="medium",v.width=E.width,v.height=E.height,X.fillStyle="white",X.fillRect(0,0,v.width,v.height),X.save(),X.translate(v.width/2,v.height/2),X.translate(g.offsetX||0,g.offsetY||0),g.rotation&&g.rotation!==0&&X.rotate(g.rotation*Math.PI/180);const W=g.rotation||0,H=Oa(N.width,N.height,v.width,v.height,W),J=P/100,Y=H*J,Q=N.width*Y,V=N.height*Y,ee=N.pristineOriginal||N.originalCanvas||N.canvas;ee&&X.drawImage(ee,-Q/2,-V/2,Q,V),X.restore();let oe=v,he=null;if(L){console.log(`‚úÇÔ∏è Applying stored crop to lazy-loaded page ${N.pageNumber}`);const ie=Math.round(L.x*v.width),ce=Math.round(L.y*v.height),re=Math.round(L.width*v.width),we=Math.round(L.height*v.height),ae=document.createElement("canvas");ae.width=re,ae.height=we;const ke=ae.getContext("2d");ke&&ke.drawImage(v,ie,ce,re,we,0,0,re,we),oe=document.createElement("canvas"),oe.width=E.width,oe.height=E.height;const ue=oe.getContext("2d");ue&&(ue.fillStyle="white",ue.fillRect(0,0,oe.width,oe.height),ue.drawImage(ae,ie,ce)),he=L}return{...N,canvas:oe,edited:!0,thumbnail:Ye(oe,.5,.6),editHistory:{...g,cropArea:he}}}catch(g){return console.error(`‚ùå Error applying stored settings to page ${N.pageNumber}:`,g),N}},Ie=(N,p)=>{if(p!=="BW")return N;const l=document.createElement("canvas");l.width=N.width,l.height=N.height;const g=l.getContext("2d",{alpha:!1,willReadFrequently:!1});return g?(g.imageSmoothingEnabled=!0,g.imageSmoothingQuality="high",g.fillStyle="white",g.fillRect(0,0,l.width,l.height),g.filter="grayscale(100%)",g.drawImage(N,0,0),l):(console.error("Failed to get 2d context for color filter"),N)},Rt=(N,p,l)=>{const g=document.createElement("canvas"),P=g.getContext("2d",{alpha:!1,willReadFrequently:!1});if(!P)return console.error("Failed to get 2d context for grid combination"),N;P.imageSmoothingEnabled=!0,P.imageSmoothingQuality="high";const z=.3,L=l.width*z,E=l.height*z,v=8;g.width=L*2+v,g.height=E,P.fillStyle="white",P.fillRect(0,0,g.width,g.height);const X=g.width/2,W=2;P.strokeStyle="#3B82F6",P.lineWidth=1,P.setLineDash([4,4]),P.strokeRect(W,W,X-v/2-W,g.height-W*2),P.strokeRect(X+v/2,W,X-v/2-W,g.height-W*2),P.setLineDash([]);const H=X-v/2-W*4,J=g.height-W*6,Y=(Q,V,ee)=>{const oe=Q.width/Q.height,he=H/J;let ie,ce,re,we;oe>he?(ie=H,ce=H/oe,re=V,we=ee+(J-ce)/2):(ce=J,ie=J*oe,re=V+(H-ie)/2,we=ee),P.drawImage(Q,re,we,ie,ce)};return Y(N,W*2,W*3),Y(p,X+v/2+W*2,W*3),g};class Ba{constructor(p="PDFEditor",l=!0){this.name=p,this.enableLogging=l,this.marks=new Map,this.measures=new Map,this.pageTimings=[],this.startTime=null,this.firstPageReady=null,this.editorReady=null}start(){this.startTime=performance.now(),this.marks.clear(),this.measures.clear(),this.pageTimings=[],this.firstPageReady=null,this.editorReady=null,this.log("üöÄ Performance tracking started")}mark(p){const l=performance.now();if(this.marks.set(p,l),this.startTime){const g=l-this.startTime;this.log(`‚è±Ô∏è [${p}] at ${this.formatDuration(g)}`)}}measure(p,l,g,P={}){const z=this.marks.get(l),L=this.marks.get(g)||performance.now();if(!z)return console.warn(`No start mark found for: ${l}`),null;const E=L-z,v={start:z,end:L,duration:E,metadata:P,label:p};return this.measures.set(p,v),this.log(`üìä [${p}] took ${this.formatDuration(E)}`,P),E}recordPageLoad(p,l,g,P="progressive",z={}){const L=g-l,E={pageNum:p,startTime:l,endTime:g,duration:L,type:P,...z};this.pageTimings.push(E),!this.firstPageReady&&P==="first"&&(this.firstPageReady=L);const v=this.startTime?l-this.startTime:0;return this.log(`üìÑ Page ${p} (${P}): ${this.formatDuration(L)} (started at +${this.formatDuration(v)})`),L>500&&console.warn(`‚ö†Ô∏è Slow page load detected: Page ${p} took ${this.formatDuration(L)}`),L}markEditorReady(){this.startTime&&(this.editorReady=performance.now()-this.startTime,this.log(`‚úÖ Editor Interactive: ${this.formatDuration(this.editorReady)}`))}getPageStats(){if(this.pageTimings.length===0)return null;const p=this.pageTimings.map(X=>X.duration),l=p.reduce((X,W)=>X+W,0),g=l/p.length,P=Math.min(...p),z=Math.max(...p),L=[...p].sort((X,W)=>X-W),E=L.length%2===0?(L[L.length/2-1]+L[L.length/2])/2:L[Math.floor(L.length/2)],v=this.pageTimings.filter(X=>X.duration>500);return{totalPages:this.pageTimings.length,avgDuration:g,minDuration:P,maxDuration:z,medianDuration:E,totalTime:l,slowPages:v.map(X=>({page:X.pageNum,duration:X.duration}))}}generateReport(){if(!this.startTime){console.warn("Performance logger was never started");return}const p=performance.now()-this.startTime,l=this.getPageStats(),g={"üìä Total Time":this.formatDuration(p),"‚ö° Editor Ready":this.editorReady?this.formatDuration(this.editorReady):"N/A","üìÑ First Page":this.firstPageReady?this.formatDuration(this.firstPageReady):"N/A"};return l&&(g["üìö Pages Loaded"]=l.totalPages,g["‚è±Ô∏è Avg Page Time"]=this.formatDuration(l.avgDuration),g["üêå Slowest Page"]=this.formatDuration(l.maxDuration),g["‚ö° Fastest Page"]=this.formatDuration(l.minDuration),g["üìä Median Page Time"]=this.formatDuration(l.medianDuration)),g}logSummary(){if(!this.enableLogging)return;const p=this.generateReport(),l=this.getPageStats();if(console.groupCollapsed(`üìä ${this.name} Performance Summary`),console.table(p),l&&l.slowPages.length>0&&(console.group("‚ö†Ô∏è Slow Pages (>500ms)"),console.table(l.slowPages),console.groupEnd()),this.measures.size>0){console.group("üìè Detailed Measurements");const g=Array.from(this.measures.entries()).map(([P,z])=>({Stage:P,Duration:this.formatDuration(z.duration),Metadata:JSON.stringify(z.metadata)}));console.table(g),console.groupEnd()}if(this.pageTimings.length>0&&this.pageTimings.length<=20){console.group("üìÑ Page Load Timeline (first 20)");const g=this.pageTimings.slice(0,20).map(P=>({Page:P.pageNum,Type:P.type,Duration:this.formatDuration(P.duration),"Started At":this.formatDuration(P.startTime-this.startTime)}));console.table(g),console.groupEnd()}console.groupEnd()}log(p,l=null){this.enableLogging&&(l?console.log(`[${this.name}] ${p}`,l):console.log(`[${this.name}] ${p}`))}formatDuration(p){return p<1?`${p.toFixed(2)}ms`:p<1e3?`${Math.round(p)}ms`:`${(p/1e3).toFixed(2)}s`}getElapsed(){return this.startTime?performance.now()-this.startTime:0}createTimer(p){const l=performance.now();return{end:(g={})=>{const z=performance.now()-l;return this.log(`‚è±Ô∏è [${p}] ${this.formatDuration(z)}`,g),z}}}trackPageLoad(p,l="progressive"){const g=performance.now(),P=[];return{step:z=>{const L=performance.now(),E=L-(P.length>0?P[P.length-1].endTime:g);return P.push({name:z,startTime:P.length>0?P[P.length-1].endTime:g,endTime:L,duration:E}),p<=5&&this.log(`  ‚îú‚îÄ ${z}: ${this.formatDuration(E)}`),this},complete:(z={})=>{const L=performance.now();return p<=5&&P.length>0&&(this.log(`  ‚îî‚îÄ Total: ${this.formatDuration(L-g)}`),this.log(`     Path: ${P.map(E=>E.name).join(" ‚Üí ")}`)),this.recordPageLoad(p,g,L,l,{...z,steps:P})}}}reset(){this.marks.clear(),this.measures.clear(),this.pageTimings=[],this.startTime=null,this.firstPageReady=null,this.editorReady=null}}const qa=(N,p=!0)=>new Ba(N,p);Qt.GlobalWorkerOptions.workerSrc=Fa;const Ve=new Map,Za=({file:N,initialPageIndex:p=0,onSave:l,onCancel:g,directPageEdit:P=!1,pageSize:z=xa,onPageSizeChange:L,colorMode:E="BW",pagesPerSheet:v=1,selectedPages:X=[],onPageSelect:W=null})=>{var zt;console.log("üìÑ PDFEditor mounted with pagesPerSheet:",v,"Type:",typeof v);const[H,J]=R.useState([]),[Y,Q]=R.useState([]),[V,ee]=R.useState([]),[oe,he]=R.useState(!1),[ie,ce]=R.useState(null),[re,we]=R.useState(null),[ae,ke]=R.useState(null),[ue,Ze]=R.useState(z),_e=R.useRef({}),M=R.useRef(null);R.useEffect(()=>{z!==ue&&Ze(z)},[z]);const[Ee,Se]=R.useState(!1),[be,Ke]=R.useState(p),[ht,ut]=R.useState(p+1),[q,Ae]=R.useState({rotation:0,scale:100,offsetX:0,offsetY:0}),[mt,Je]=R.useState(100),[et,Oe]=R.useState(!1),[_,Te]=R.useState(null),[pt,Ft]=R.useState(!1),[Vt,Et]=R.useState(null),[B,Zt]=R.useState({x:0,y:0}),Ne=R.useRef(null),[Ga,tt]=R.useState(null),[ft,_t]=R.useState(!1),[de,at]=R.useState(1),[ze,xt]=R.useState("pagesize"),[wt,Kt]=R.useState(z),[Jt,bt]=R.useState(!1),[st,nt]=R.useState(!1),[ea,We]=R.useState(0),[De,Dt]=R.useState(!1),[Mt,yt]=R.useState(0),xe=R.useRef(null),ta=R.useRef(null),Ue=R.useRef(null),aa=R.useRef(!1),Pe=R.useRef(null),ye=R.useRef(new Set),Me=R.useRef(null),me=R.useRef(new Map),sa=R.useRef([]);R.useRef(!1);const ot=R.useRef(!1),na=2,Xe=R.useRef(null),Lt=t=>t?`${t.name}_${t.size}_${t.lastModified}`:null,Be=t=>{let a=Pt(t);if(Y.length>0){const d=Y[0];d.width>d.height&&a.width<a.height&&(a={...a,width:a.height,height:a.width})}return a};R.useEffect(()=>{var t,a,d;if(N&&N.type==="application/pdf"){const n=Lt(N);Xe.current&&Xe.current!==n&&((t=M.current)==null||t.log("üîÑ New file detected - cleaning up previous file"),Xe.current&&(Ve.delete(Xe.current),(a=M.current)==null||a.log(`üóëÔ∏è Cleared cache for old file: ${Xe.current}`)),Me.current&&(Me.current.abort(),Me.current=null),ye.current.clear(),me.current.clear(),sa.current=[],ot.current=!1,J([]),Q([]),ee([]));const o=Ve.get(n);if(o&&o.loading){(d=M.current)==null||d.log("‚è∏Ô∏è Same file already loading (React Strict Mode) - skipping duplicate"),Me.current=o.controller,Xe.current=n;return}Xe.current=n,oa()}return()=>{var n;(n=M.current)==null||n.log("üßπ Component unmounting (cleanup)")}},[N]),R.useEffect(()=>{console.log("üîÑ useEffect triggered:",{pagesPerSheet:v,colorMode:E,originalPagesLength:Y.length}),Y.length>0?(console.log("‚úÖ Calling updateGridThumbnails because originalPages exist"),It()):console.log("‚ö†Ô∏è Skipping updateGridThumbnails - no originalPages yet")},[v,E]),R.useEffect(()=>{v===2&&Y.length>0&&(console.log("üîÑ N-up mode: originalPages changed, updating sheets"),It())},[Y.length,v]),R.useEffect(()=>{Ke(p),ut(p+1),P&&H.length>0&&Se(!0)},[p,P]),R.useEffect(()=>{if(H.length>0&&ht){const t=H.findIndex(a=>a.pageNumber===ht);t!==-1&&t!==be&&(console.log(`üìç Recalculating editingPageIndex from ${be} to ${t}`),Ke(t))}},[H.length,ht]),R.useEffect(()=>{P&&H.length>0&&!Ee&&Se(!0)},[H,P,Ee]),R.useEffect(()=>(H.length>0&&Ee&&(Ue.current&&clearTimeout(Ue.current),Ue.current=setTimeout(()=>{Ne.current&&cancelAnimationFrame(Ne.current),Ne.current=requestAnimationFrame(()=>{ra(),Ne.current=null})},50)),()=>{Ue.current&&clearTimeout(Ue.current),Ne.current&&cancelAnimationFrame(Ne.current)}),[q,be,Ee,ue,E,v]);const oa=async()=>{var d;let t=null;const a=Lt(N);try{M.current||(M.current=qa("PDFEditor",!0)),M.current.start(),Me.current&&(M.current.log("‚ö†Ô∏è Aborting previous controller before creating new one"),Me.current.abort()),Me.current=new AbortController,t=Me.current;const n=t.signal;M.current.log(`üìå Created new controller for file: ${a}`),Ve.set(a,{loading:!0,controller:t,pdf:null}),me.current.clear(),ye.current.clear(),ot.current=!1,he(!0),ce("parsing"),we(null),aa.current=!1;const o=Array.from({length:12},(h,A)=>({pageNumber:A+1,isLoaded:!1,isLoading:!0,thumbnail:null,width:595,height:842,canvas:null,originalCanvas:null,edited:!1}));ee(o),M.current.mark("File Load Start");const r=await N.arrayBuffer();M.current.mark("File Load Complete"),M.current.measure("File to ArrayBuffer","File Load Start","File Load Complete",{size:r.byteLength,sizeFormatted:`${(r.byteLength/1024/1024).toFixed(2)} MB`}),M.current.mark("PDF Parse Start");const m=await Qt.getDocument({data:r}).promise;M.current.mark("PDF Parse Complete"),M.current.measure("PDF Parsing","PDF Parse Start","PDF Parse Complete",{pages:m.numPages}),ke(m);const b=m.numPages,D=Number.isFinite(p)?p:0,C=Math.min(D+1,b);M.current.mark("Placeholders Start");const S=[];if(v===2)for(let h=1;h<=b;h+=2){const A=h,k=h+1,f=k<=b?`${A}-${k}`:`${A}`;S.push({pageNumber:f,isSheet:k<=b,containsPages:k<=b?[A,k]:[A],isLoaded:!1,isLoading:!1,thumbnail:null,width:595,height:842,canvas:null,originalCanvas:null,edited:!1})}else for(let h=1;h<=b;h++)S.push({pageNumber:h,isLoaded:!1,isLoading:!1,thumbnail:null,width:595,height:842,canvas:null,originalCanvas:null,edited:!1});ee(S),ce("loading"),M.current.mark("Placeholders Complete"),M.current.measure("Create Placeholders","Placeholders Start","Placeholders Complete",{count:b}),he(!1),M.current.markEditorReady(),M.current.log(`üìÑ Loading first page (${C})...`),me.current.set(C,"loading"),ye.current.add(C);const s=M.current.trackPageLoad(C,"first"),w=await At(m,C,s,{thumbnailScale:.5,thumbnailQuality:.4});if(s.complete({requestedPage:!0}),n.aborted){M.current.log(`üõë Load aborted after first page render (signal aborted, fileId: ${a})`),me.current.delete(C),ye.current.delete(C);return}if(w){me.current.set(C,"loaded"),ye.current.delete(C);const h={...w,canvas:w.originalCanvas,thumbnail:w.thumbnail,edited:!1,editHistory:{rotation:0,scale:100,offsetX:0,offsetY:0,cropArea:null}};Q(A=>{const k=[...A];return k[C-1]=h,k.filter(f=>f!=null)}),J(A=>{const k=[...A];return k[C-1]=h,k.filter(f=>f!=null)}),Ke(0),ut(w.pageNumber),ee(A=>A.map(k=>k.pageNumber===w.pageNumber?{...w,isLoaded:!0,isLoading:!1}:k)),M.current.log("‚úÖ First page loaded - editor ready!"),ce("ready")}M.current.mark("Progressive Loading Start");const x=[],c=Math.max(1,C-1),i=Math.min(b,C+1);for(let h=c;h<=i;h++)h!==C&&x.push(h);for(let h=1;h<=b;h++)(h<c||h>i)&&x.push(h);M.current.log(`üìÑ Queued ${x.length} pages for progressive loading`);let j=1;const y=async()=>{if(n.aborted){M.current.log("üõë Progressive loading aborted");return}if(x.length===0){M.current.mark("Progressive Loading Complete"),M.current.measure("All Pages Loaded","Progressive Loading Start","Progressive Loading Complete",{totalPages:b,loadedCount:j}),M.current.log(`‚úÖ All ${j} pages loaded`),M.current.logSummary(),ot.current=!0;return}const h=x.shift(),A=me.current.get(h);if(A==="loaded"||A==="loading"){M.current.log(`‚è≠Ô∏è Page ${h} already ${A}, skipping`),x.length>0&&(typeof requestIdleCallback<"u"?requestIdleCallback(()=>y(),{timeout:100}):setTimeout(()=>y(),10));return}try{me.current.set(h,"loading"),ye.current.add(h);const k=M.current.trackPageLoad(h,"progressive"),f=await At(m,h,k,{thumbnailScale:.5,thumbnailQuality:.4});if(k.complete(),n.aborted){M.current.log("üõë Progressive loading aborted after render"),me.current.delete(h),ye.current.delete(h),ee(u=>u.map(I=>I.pageNumber===h?{...I,isLoading:!1}:I));return}if(f){me.current.set(h,"loaded"),ye.current.delete(h);let u=f,I={...f,canvas:f.originalCanvas,thumbnail:f.thumbnail,edited:!1,editHistory:{rotation:0,scale:100,offsetX:0,offsetY:0,cropArea:null}};Pe.current&&(console.log(`üìù [BACKGROUND LOAD] Applying stored Apply All settings to page ${h}`,Pe.current.settings),u=await Gt(f,Pe.current,Pt),console.log(`‚úÖ [BACKGROUND LOAD] Apply All settings applied to page ${h}`),I={...u,pristineOriginal:f.originalCanvas}),Q(F=>F.find(U=>U.pageNumber===h)?F:[...F,I].sort((U,te)=>U.pageNumber-te.pageNumber)),J(F=>F.find(U=>U.pageNumber===h)?F:[...F,u].sort((U,te)=>U.pageNumber-te.pageNumber)),ee(F=>F.map(Z=>Z.pageNumber===h?{...u,isLoaded:!0,isLoading:!1}:Z)),j++;const $=Math.round(j/b*100);M.current.log(`‚úÖ Page ${h} loaded (${j}/${b} - ${$}%)`)}}catch(k){M.current.log(`‚ùå Error loading page ${h}: ${k.message}`),console.error(`‚ùå Error loading page ${h}:`,k),me.current.delete(h),ye.current.delete(h)}x.length>0&&(typeof requestIdleCallback<"u"?requestIdleCallback(()=>y(),{timeout:100}):setTimeout(()=>y(),10))};y(),M.current.log("‚úÖ PDF Editor - Initial page loaded, progressive loading started"),M.current.log(`‚ÑπÔ∏è Remaining ${b-1} pages loading progressively in background`)}catch(n){console.error("‚ùå Error loading PDF:",n),(d=M.current)==null||d.log(`‚ùå Fatal error: ${n.message}`),we("Failed to load PDF: "+n.message),Ve.delete(a)}finally{he(!1);const n=Ve.get(a);n&&(n.loading=!1)}},He=R.useCallback(async t=>{var o,r,m,b,D,C;if(!ae)return;const a=Me.current,d=a==null?void 0:a.signal;if(t<=na&&!ot.current){(o=M.current)==null||o.log(`‚è∏Ô∏è Page ${t} in initial batch, skipping on-demand load`);return}const n=me.current.get(t);if(n==="loaded"||n==="loading"){(r=M.current)==null||r.log(`‚è≠Ô∏è Page ${t} already ${n}, skipping on-demand load`);return}if(d!=null&&d.aborted){(m=M.current)==null||m.log("üõë On-demand load aborted");return}me.current.set(t,"loading"),ye.current.add(t),ee(S=>S.map(s=>s.pageNumber===t?{...s,isLoading:!0}:s));try{const S=(b=M.current)==null?void 0:b.trackPageLoad(t,"on-demand");(D=M.current)==null||D.log(`üì• Loading page ${t} on demand`);const s=await At(ae,t,void 0,{thumbnailScale:.5,thumbnailQuality:.4});if(S==null||S.complete(),d!=null&&d.aborted){(C=M.current)==null||C.log("üõë On-demand load aborted after render"),me.current.delete(t),ye.current.delete(t),ee(w=>w.map(x=>x.pageNumber===t?{...x,isLoading:!1}:x));return}if(s){me.current.set(t,"loaded"),ye.current.delete(t);const w={...s,canvas:s.originalCanvas,thumbnail:s.thumbnail,edited:!1,editHistory:{rotation:0,scale:100,offsetX:0,offsetY:0,cropArea:null}};let x=s,c=w;Pe.current&&(console.log(`üìù [LAZY LOAD] Applying stored settings to page ${t}`,Pe.current.settings),x=await Gt(s,Pe.current,Pt),console.log(`‚úÖ [LAZY LOAD] Settings applied to page ${t} successfully`),c={...x,pristineOriginal:s.originalCanvas}),v!==2?J(i=>i.find(j=>j.pageNumber===t)?(console.log(`‚ö†Ô∏è Page ${t} already in pages array, skipping`),i):[...i,x].sort((j,y)=>j.pageNumber-y.pageNumber)):console.log(`üìÑ N-up mode: Skipping individual page ${t} add to pages array`),Q(i=>i.find(j=>j.pageNumber===t)?i:[...i,c].sort((j,y)=>j.pageNumber-y.pageNumber)),ee(i=>i.map(j=>j.pageNumber===t?{...x,isLoaded:!0,isLoading:!1}:j)),console.log(`‚úÖ Loaded page ${t}`)}}catch(S){console.error(`‚ùå Error loading page ${t}:`,S),ee(s=>s.map(w=>w.pageNumber===t?{...w,isLoading:!1}:w)),ye.current.delete(t),me.current.delete(t)}},[ae,Pe,V]);R.useEffect(()=>{if(V.length===0||!He)return;const t=new IntersectionObserver(a=>{a.forEach(d=>{if(d.isIntersecting){const n=d.target.dataset.pageNumber;if(n.includes("-")){const[o,r]=n.split("-").map(m=>parseInt(m));console.log(`üìÑ Sheet ${n} visible - loading pages ${o} and ${r}`),He(o),r&&He(r)}else{const o=parseInt(n);He(o)}}})},{root:null,rootMargin:"600px",threshold:.01});return Object.values(_e.current).forEach(a=>{a&&t.observe(a)}),()=>t.disconnect()},[V.length,ae,He]);const It=async()=>{if(console.log("üîÑ updateGridThumbnails called:",{pagesPerSheet:v,originalPagesCount:Y.length,colorMode:E}),console.log("üîç pagesPerSheet value:",v,"Type:",typeof v,"Equals 2?:",v===2,'Equals "2"?:',v==="2"),v===2){console.log("üìÑ Creating N-up sheets from",Y.length,"pages");const t=[];for(let n=0;n<Y.length;n+=2){const o=Y[n],r=Y[n+1];if(!o||!o.canvas){console.warn(`‚ö†Ô∏è Page ${n+1} is missing or has no canvas, skipping sheet creation`);continue}const m=Ie(o.canvas,E);if(r&&r.canvas){const b=Ie(r.canvas,E),D=Rt(m,b,Be(ue)),C={pageNumber:`${o.pageNumber}-${r.pageNumber}`,canvas:D,originalCanvas:D,thumbnail:Ye(D,.5,.6),width:D.width,height:D.height,isSheet:!0,containsPages:[o.pageNumber,r.pageNumber],edited:!!(o!=null&&o.edited||r!=null&&r.edited)};t.push(C),console.log(`‚úÖ Created sheet ${o.pageNumber}-${r.pageNumber}`)}else{const b={...o,canvas:m,width:m.width,height:m.height,thumbnail:Ye(m,.5,.6),isSheet:!1};t.push(b),console.log(`‚úÖ Added single page ${o.pageNumber}`)}}console.log(`‚úÖ Created ${t.length} N-up sheets/pages, setting as pages`),J(t);const a=(ae==null?void 0:ae.numPages)||Y.length*2,d=[];for(let n=1;n<=a;n+=2){const o=n,r=n+1,m=r<=a?`${o}-${r}`:`${o}`,b=t.find(C=>C.pageNumber===m),D=V.find(C=>C.pageNumber===m);b?d.push({...b,isLoaded:!0,isLoading:!1,edited:!!(b!=null&&b.edited||D!=null&&D.edited)}):d.push({pageNumber:m,isSheet:r<=a,containsPages:r<=a?[o,r]:[o],isLoaded:!1,isLoading:!1,thumbnail:null,width:595,height:842,canvas:null,originalCanvas:null,edited:!!(D!=null&&D.edited)})}ee(d),console.log(`üìã Created ${d.length} sheet placeholders in allPages`)}else{console.log("üìÑ Updating individual pages with color filter");const t=Y.map(o=>{const r=Ie(o.canvas,E);return{...o,canvas:r,thumbnail:o.thumbnail||r.toDataURL("image/jpeg",.6)}});J(t);const a=(ae==null?void 0:ae.numPages)||t.length,d=[];for(let o=1;o<=a;o++){const r=t.find(b=>b.pageNumber===o),m=V.find(b=>b.pageNumber===o);r?d.push({...r,isLoaded:!0,isLoading:!1,edited:!!(r!=null&&r.edited||m!=null&&m.edited)}):d.push({pageNumber:o,isLoaded:!1,isLoading:!1,thumbnail:null,width:595,height:842,canvas:null,originalCanvas:null,edited:!!(m!=null&&m.edited)})}ee(d);const n=d.filter(o=>o.edited).length;console.log(`üìã Created ${d.length} individual page placeholders in allPages (${n} marked as edited)`)}},Xt=t=>{var n;Ke(t),ut((n=H[t])==null?void 0:n.pageNumber),Se(!0),xt("pagesize"),Oe(!1),Te(null),tt(null);const a=H[t];let d=a;if(v===2&&(a!=null&&a.isSheet)){let o=t*2;const r=Y[o];r&&(d=r,console.log(`üìÑ N-up mode: Loading editHistory from original page ${r.pageNumber}`))}if(d&&d.editHistory){const o=d.editHistory.scale||100;Ae({rotation:d.editHistory.rotation||0,scale:o,offsetX:d.editHistory.offsetX||0,offsetY:d.editHistory.offsetY||0}),Je(o),console.log("‚úÖ Loaded editHistory:",d.editHistory)}else Ae({rotation:0,scale:100,offsetX:0,offsetY:0}),Je(100),console.log("üìÑ No editHistory found - using defaults");at(1)},ia=()=>{xt("pagesize"),Oe(!1),Te(null),tt(null),at(1),P?g():Se(!1)},ra=()=>{var C,S;if(!H[be]||!xe.current)return;const t=be,a=H[t];let d=t;v===2&&(a.isSheet?d=t*2:(d=Y.findIndex(s=>s.pageNumber===a.pageNumber),d===-1&&(console.error("‚ùå Could not find original page for",a.pageNumber),d=t)));const n=Y[d],o=xe.current,r=o.getContext("2d",{alpha:!1,willReadFrequently:!1});r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high";const m=Be(ue),b=v===2&&a.isSheet;console.log("üìÑ Current page in editor:",{pageNumber:a.pageNumber,isSheet:a.isSheet,pagesPerSheet:v,isNupMode:b,originalPageDims:n?`${n.width}x${n.height}`:"N/A",canvasDims:`${m.width}x${m.height}`});const D=(s,w,x)=>{var k;const c=s.getContext("2d",{alpha:!1,willReadFrequently:!1});if(c.imageSmoothingEnabled=!0,c.imageSmoothingQuality="high",x.cropArea&&((k=w.editHistory)!=null&&k.isCropped)&&w.canvas){console.log("‚úÇÔ∏è Using pre-centered cropped canvas (already centered, drawing directly)"),c.clearRect(0,0,s.width,s.height),c.fillStyle="white",c.fillRect(0,0,s.width,s.height);const f=w.canvas;if(f.width===s.width&&f.height===s.height)c.drawImage(f,0,0);else{const u=s.width/f.width,I=s.height/f.height,$=Math.min(u,I)*.9,F=f.width*$,Z=f.height*$,U=(s.width-F)/2,te=(s.height-Z)/2;c.drawImage(f,U,te,F,Z),console.log(`  üìè Scaled pre-centered canvas from ${f.width}√ó${f.height} to ${F.toFixed(1)}√ó${Z.toFixed(1)} at (${U.toFixed(1)}, ${te.toFixed(1)})`)}if(E==="BW"){const u=document.createElement("canvas");u.width=s.width,u.height=s.height;const I=u.getContext("2d");I.filter="grayscale(100%)",I.drawImage(s,0,0),c.clearRect(0,0,s.width,s.height),c.fillStyle="white",c.fillRect(0,0,s.width,s.height),c.drawImage(u,0,0)}return}const i=w.pristineOriginal||w.originalCanvas||w.canvas,j=w.width,y=w.height,h={rotation:x.rotation,scale:x.scale,offsetX:x.offsetX,offsetY:x.offsetY,cropArea:x.cropArea},A=qt({width:j,height:y},m,h);if(c.clearRect(0,0,s.width,s.height),c.fillStyle="white",c.fillRect(0,0,s.width,s.height),c.save(),c.translate(s.width/2,s.height/2),c.translate(x.offsetX,x.offsetY),x.rotation!==0&&c.rotate(x.rotation*Math.PI/180),c.drawImage(i,A.sourceRect.x,A.sourceRect.y,A.sourceRect.width,A.sourceRect.height,A.drawX,A.drawY,A.drawWidth,A.drawHeight),c.restore(),E==="BW"){const f=document.createElement("canvas");f.width=s.width,f.height=s.height;const u=f.getContext("2d");u.filter="grayscale(100%)",u.drawImage(s,0,0),c.clearRect(0,0,s.width,s.height),c.fillStyle="white",c.fillRect(0,0,s.width,s.height),c.drawImage(f,0,0)}};if(b){console.log("üîÑ N-up mode: Rendering 2 pages side-by-side");const s=document.createElement("canvas");s.width=m.width,s.height=m.height;const w=document.createElement("canvas");w.width=m.width,w.height=m.height;const x={rotation:q.rotation,scale:q.scale,offsetX:q.offsetX,offsetY:q.offsetY,cropArea:_||((C=a.editHistory)==null?void 0:C.cropArea)};D(s,n,x);const c=d+1;if(c<Y.length){const f=Y[c];console.log("üîÑ Rendering Page 2:",f.pageNumber),D(w,f,x)}else{const f=w.getContext("2d");f.fillStyle="white",f.fillRect(0,0,w.width,w.height)}const i=12;o.width=s.width*2+i,o.height=s.height,r.fillStyle="white",r.fillRect(0,0,o.width,o.height);const j=o.width/2,y=3;r.strokeStyle="#3B82F6",r.lineWidth=2,r.setLineDash([6,6]),r.strokeRect(y,y,j-i/2-y,o.height-y*2),r.strokeRect(j+i/2,y,j-i/2-y,o.height-y*2),r.setLineDash([]);const h=j-i/2-y*3,A=o.height-y*4;r.drawImage(s,y*2,y*2,h,A),r.drawImage(w,j+i/2+y,y*2,h,A),r.fillStyle="#3B82F6",r.font="bold 14px Inter, sans-serif",r.textAlign="center";const k=c<Y.length?`Pages ${d+1}-${c+1} (2 Per Sheet)`:`Page ${d+1} (2 Per Sheet)`;r.fillText(k,o.width/2,o.height-8)}else{console.log("üìÑ Single page mode: Rendering single page"),o.width=m.width,o.height=m.height;const s={rotation:q.rotation,scale:q.scale,offsetX:q.offsetX,offsetY:q.offsetY,cropArea:_||((S=a.editHistory)==null?void 0:S.cropArea)};D(o,n,s)}setTimeout(Yt,150)},Yt=()=>{if(!xe.current){console.log("‚ùå Canvas not found for updateImageRect");return}const t=xe.current,a=t.getBoundingClientRect(),d=t.closest(".image-container"),n=d?d.getBoundingClientRect():{left:0,top:0},o={left:a.left-n.left,top:a.top-n.top,width:a.width,height:a.height};console.log("üìê Image rect calculated:",{canvasRect:a,containerRect:n,imageRect:o}),tt(o)},vt=(t,a,d,n,o=!1)=>{if(o){const r=t/d,m=a/n,b=Math.min(r,m),D=d*b,C=n*b,S=(t-D)/2,s=(a-C)/2;return console.log(`‚úÇÔ∏è CROP CENTERING: page=${t}√ó${a}, crop=${d}√ó${n}, scale=${b.toFixed(3)}, draw at (${S.toFixed(1)}, ${s.toFixed(1)}) size ${D.toFixed(1)}√ó${C.toFixed(1)}`),{drawX:S,drawY:s,drawWidth:D,drawHeight:C}}else{const r=(t-d)/2,m=(a-n)/2;return console.log(`‚úÇÔ∏è CROP CENTERING: page=${t}√ó${a}, crop=${d}√ó${n}, NO SCALE, draw at (${r.toFixed(1)}, ${m.toFixed(1)})`),{drawX:r,drawY:m,drawWidth:d,drawHeight:n}}},la=()=>{console.log("üéØ Starting crop mode"),Oe(!0),setTimeout(()=>{const t=xe.current;if(t){const a=t.getBoundingClientRect(),n=t.closest(".image-container").getBoundingClientRect(),o={left:a.left-n.left,top:a.top-n.top,width:a.width,height:a.height};tt(o);const r=t.width,m=t.height,b=r*.8,D=m*.8,C=(r-b)/2,S=(m-D)/2;console.log("üéØ Initializing crop in CANVAS PIXEL SPACE (page boundaries):",{canvasSize:`${r}√ó${m}`,cropArea:`${C.toFixed(1)}, ${S.toFixed(1)}, ${b.toFixed(1)}√ó${D.toFixed(1)}`}),Te({x:C,y:S,width:b,height:D}),console.log("üéØ Canvas boundaries set:",o)}},200)},it=(t,a)=>{if(!et||!_)return;t.preventDefault(),t.stopPropagation(),console.log("üñ±Ô∏è Mouse down on handle:",a,"Current zoom:",de),Ft(!0),Et(a);const o=xe.current.closest(".image-container").getBoundingClientRect(),r=(t.clientX-o.left)/de,m=(t.clientY-o.top)/de;Zt({domX:r,domY:m,cropX:_.x,cropY:_.y,cropWidth:_.width,cropHeight:_.height})},kt=t=>{!pt||!_||(t.preventDefault(),Ne.current&&cancelAnimationFrame(Ne.current),Ne.current=requestAnimationFrame(()=>{const a=xe.current;if(!a)return;const n=a.closest(".image-container").getBoundingClientRect(),o=a.getBoundingClientRect(),r=(t.clientX-n.left)/de,m=(t.clientY-n.top)/de,b=r-B.domX,D=m-B.domY,C=o.width/de,S=o.height/de,s=C/a.width,w=S/a.height,x=b/s,c=D/w;console.log("üéØ Crop drag at zoom "+(de*100).toFixed(0)+"%:",{domDelta:`(${b.toFixed(1)}, ${D.toFixed(1)})`,canvasDOMSize:`${C.toFixed(1)}√ó${S.toFixed(1)}`,canvasPixelSize:`${a.width}√ó${a.height}`,ratio:`${s.toFixed(3)}`,pixelDelta:`(${x.toFixed(1)}, ${c.toFixed(1)})`});let i={..._};const j=50,y=10;switch(a.width-y*2,a.height-y*2,Vt){case"nw":const h=Math.max(y,Math.min(B.cropX+x,B.cropX+B.cropWidth-j)),A=Math.max(y,Math.min(B.cropY+c,B.cropY+B.cropHeight-j));i.x=h,i.y=A,i.width=B.cropWidth-(h-B.cropX),i.height=B.cropHeight-(A-B.cropY);break;case"ne":const k=Math.max(y,Math.min(B.cropY+c,B.cropY+B.cropHeight-j));i.y=k,i.width=Math.max(j,Math.min(B.cropWidth+x,a.width-B.cropX-y)),i.height=B.cropHeight-(k-B.cropY);break;case"sw":const f=Math.max(y,Math.min(B.cropX+x,B.cropX+B.cropWidth-j));i.x=f,i.width=B.cropWidth-(f-B.cropX),i.height=Math.max(j,Math.min(B.cropHeight+c,a.height-B.cropY-y));break;case"se":i.width=Math.max(j,Math.min(B.cropWidth+x,a.width-B.cropX-y)),i.height=Math.max(j,Math.min(B.cropHeight+c,a.height-B.cropY-y));break;case"center":i.x=Math.max(y,Math.min(B.cropX+x,a.width-B.cropWidth-y)),i.y=Math.max(y,Math.min(B.cropY+c,a.height-B.cropHeight-y));break}i.x=Math.max(y,Math.min(i.x,a.width-j-y)),i.y=Math.max(y,Math.min(i.y,a.height-j-y)),i.width=Math.max(j,Math.min(i.width,a.width-i.x-y)),i.height=Math.max(j,Math.min(i.height,a.height-i.y-y)),i.x+i.width>a.width-y&&(i.width=a.width-i.x-y),i.y+i.height>a.height-y&&(i.height=a.height-i.y-y),Te(i)}))},Nt=()=>{Ne.current&&(cancelAnimationFrame(Ne.current),Ne.current=null),Ft(!1),Et(null)},Tt=async()=>{if(!(!_||!H[be]))try{console.log("‚úÇÔ∏è Applying crop:",_);const t=be,a=H[t],d=Y[t],n=xe.current;if(!n){console.error("‚ùå Display canvas not available");return}if(_.width<10||_.height<10){console.warn("Crop area too small");return}let o=Math.round(_.x),r=Math.round(_.y),m=Math.round(_.width),b=Math.round(_.height);if(r<0&&(b+=r,r=0),o<0&&(m+=o,o=0),m=Math.min(m,n.width-o),b=Math.min(b,n.height-r),m=Math.max(1,m),b=Math.max(1,b),console.log(`‚úÇÔ∏è Normalized crop bounds: (${o}, ${r}) ${m}√ó${b} on canvas ${n.width}√ó${n.height}`),m<10||b<10){console.warn("‚ö†Ô∏è Normalized crop area too small after boundary adjustment");return}const D=document.createElement("canvas");D.width=m,D.height=b,D.getContext("2d").drawImage(n,o,r,m,b,0,0,m,b);const S=document.createElement("canvas");S.width=n.width,S.height=n.height;const s=S.getContext("2d");s.fillStyle="white",s.fillRect(0,0,S.width,S.height);const w=q.fitCropToPage||!1,x=vt(S.width,S.height,m,b,w);s.drawImage(D,x.drawX,x.drawY,x.drawWidth,x.drawHeight),console.log(`üìê Crop preview: cropped region (${m}√ó${b}) centered at (${x.drawX.toFixed(1)}, ${x.drawY.toFixed(1)})${w?" [FIT TO PAGE]":""}`),console.log(`üîç DIAGNOSTIC - Final canvas dimensions: ${S.width}√ó${S.height}, Aspect: ${(S.width/S.height).toFixed(3)}`),console.log(`üîç DIAGNOSTIC - Original page dimensions: ${a.width}√ó${a.height}, Display canvas was: ${n.width}√ó${n.height}`);const c={x:o/n.width,y:r/n.height,width:m/n.width,height:b/n.height},i=[...H];if(i[t]={...a,canvas:S,width:n.width,height:n.height,thumbnail:S.toDataURL("image/jpeg",.6),edited:!0,cropInfo:c,editHistory:{...a.editHistory,cropArea:c,isCropped:!0,fitCropToPage:q.fitCropToPage||!1}},J(i),v===2&&a.isSheet)console.log("‚ö†Ô∏è Cropping N-up sheets does not persist to originalPages");else{const h=[...Y],A=v===2?Y.findIndex(k=>k.pageNumber===a.pageNumber):t;if(A>=0&&A<h.length){const k=h[A];h[A]={...k,canvas:S,width:n.width,height:n.height,thumbnail:S.toDataURL("image/jpeg",.6),edited:!0,cropInfo:c,editHistory:{...k.editHistory,cropArea:c,isCropped:!0,fitCropToPage:q.fitCropToPage||!1}},Q(h),console.log("‚úÖ Crop persisted to originalPages for page",a.pageNumber)}}Oe(!1),Te(null),requestAnimationFrame(()=>{if(xe.current){const h=xe.current,A=h.getContext("2d");h.width=S.width,h.height=S.height,A.drawImage(S,0,0),setTimeout(()=>{Yt(),console.log("‚úÖ ImageRect recalculated after crop - preview should show correct width")},50)}});const j={};i.forEach(h=>{h.edited&&(j[h.pageNumber]={thumbnail:h.thumbnail,edited:!0,canvas:h.canvas,cropInfo:h.cropInfo})});const y=new CustomEvent("pdfEditorUpdate",{detail:{editedPages:j,updatedPages:i}});window.dispatchEvent(y),console.log("‚úÖ Crop applied successfully - content scaled to fill page")}catch(t){console.error("‚ùå Error applying crop:",t)}},ca=()=>{Ae({rotation:0,scale:100,offsetX:0,offsetY:0}),Je(100)},da=()=>{console.info("[ApplyAll] üö® applyToAllPages clicked - showing modal üö®"),bt(!0)},ga=async()=>{var t;console.info("[ApplyAll] ‚≠ê‚≠ê‚≠ê confirmApplyToAll START ‚≠ê‚≠ê‚≠ê",Date.now()),Dt(!0),yt(0),await new Promise(a=>setTimeout(a,0)),await new Promise(a=>requestAnimationFrame(a));try{console.log("üîÑ Apply All: Applying to loaded pages");const a=(t=H[be])==null?void 0:t.cropInfo;Pe.current={settings:{...q},userScale:mt,currentPageSize:ue,cropInfo:a},console.log("üíæ Stored Apply All settings for future-loaded pages");const d=s=>{yt(s)};d(.05),await new Promise(s=>requestAnimationFrame(s)),d(.1);const n=Be(ue),o=(ae==null?void 0:ae.numPages)||V.length;console.log(`üìÑ Processing ${Y.length} loaded pages (out of ${o} total)`),console.log("‚ö° Unloaded pages will get settings when they're viewed"),console.log("üìã Loaded page numbers:",Y.map(s=>s.pageNumber).join(", "));const r=[],m=Y.length;for(let s=0;s<Y.length;s++){const w=Y[s];console.log(`üìÑ Applying settings to loaded page ${w.pageNumber}`);const x=.1+s/m*.6;d(x),s%5===0&&await new Promise(F=>requestAnimationFrame(F));const c=document.createElement("canvas"),i=c.getContext("2d",{alpha:!1,willReadFrequently:!1});i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="medium",c.width=n.width,c.height=n.height,i.fillStyle="white",i.fillRect(0,0,c.width,c.height),i.save(),i.translate(c.width/2,c.height/2),i.translate(q.offsetX,q.offsetY),q.rotation!==0&&i.rotate(q.rotation*Math.PI/180);const j=(q.rotation%360+360)%360,y=j===90||j===270;let h;if(y){const F=c.width/w.height,Z=c.height/w.width;h=Math.min(F,Z)}else{const F=c.width/w.width,Z=c.height/w.height;h=Math.min(F,Z)}const A=q.scale/100,k=h*A,f=w.pristineOriginal||w.originalCanvas||w.canvas,u=w.width*k,I=w.height*k;i.drawImage(f,-u/2,-I/2,u,I),i.restore();let $=c;if(a){console.log(`‚úÇÔ∏è Applying universal crop to page ${s+1}`);const F=Math.round(a.x*c.width),Z=Math.round(a.y*c.height),U=Math.round(a.width*c.width),te=Math.round(a.height*c.height),le=document.createElement("canvas");le.width=U,le.height=te,le.getContext("2d").drawImage(c,F,Z,U,te,0,0,U,te),$=document.createElement("canvas"),$.width=n.width,$.height=n.height;const G=$.getContext("2d");G.fillStyle="white",G.fillRect(0,0,$.width,$.height);const T=q.fitCropToPage||!1,O=vt($.width,$.height,U,te,T);G.drawImage(le,O.drawX,O.drawY,O.drawWidth,O.drawHeight),console.log(`  üìê Canvas save crop: centered at (${O.drawX.toFixed(1)}, ${O.drawY.toFixed(1)}) with size ${O.drawWidth.toFixed(1)}√ó${O.drawHeight.toFixed(1)}${T?" [FIT TO PAGE]":""}`)}if(E==="BW"){const F=document.createElement("canvas");F.width=$.width,F.height=$.height;const Z=F.getContext("2d");Z.filter="grayscale(100%)",Z.drawImage($,0,0),$=document.createElement("canvas"),$.width=F.width,$.height=F.height;const U=$.getContext("2d");U.fillStyle="white",U.fillRect(0,0,$.width,$.height),U.drawImage(F,0,0)}r.push({...w,canvas:$,thumbnail:Ye($,.5,.6),edited:!0,cropInfo:a,pristineOriginal:w.pristineOriginal||w.originalCanvas||w.canvas,editHistory:{rotation:q.rotation,scale:q.scale,offsetX:q.offsetX,offsetY:q.offsetY,cropArea:a,fitCropToPage:q.fitCropToPage||!1}})}if(d(.7),await new Promise(s=>requestAnimationFrame(s)),d(.9),await new Promise(s=>requestAnimationFrame(s)),v===2){console.log("üìÑ Regenerating N-up sheets from processed pages");const s=[];for(let w=0;w<r.length;w+=2){const x=r[w],c=r[w+1],i=Ie(x.canvas,E);if(c){const j=Ie(c.canvas,E),y=Rt(i,j,Be(ue));s.push({pageNumber:`${x.pageNumber}-${c.pageNumber}`,canvas:y,originalCanvas:y,thumbnail:Ye(y,.5,.6),width:y.width,height:y.height,isSheet:!0,containsPages:[x.pageNumber,c.pageNumber],edited:!0})}else s.push({...x,canvas:i,width:i.width,height:i.height,thumbnail:Ye(i,.5,.6),edited:!0,isSheet:!1})}J(s),Q(r),ee(w=>w.map(x=>{const c=s.find(i=>i.isSheet&&i.containsPages?i.containsPages.includes(x.pageNumber):i.pageNumber===x.pageNumber);return c&&c.thumbnail?{...x,thumbnail:c.thumbnail,isLoaded:!0,edited:!0}:x}))}else Q(r),J(r),ee(s=>s.map(w=>{const x=r.find(c=>c.pageNumber===w.pageNumber);return x&&x.thumbnail?{...w,thumbnail:x.thumbnail,isLoaded:!0,edited:!0}:w}));const b={};r.forEach(s=>{b[s.pageNumber]={thumbnail:s.thumbnail,edited:!0,canvas:s.canvas}});const D=new CustomEvent("pdfEditorUpdate",{detail:{editedPages:b}});window.dispatchEvent(D);const C=new Event("fileUpdated");window.dispatchEvent(C);const S=o-r.length;console.log("‚úÖ Apply All Complete Summary:"),console.log(`   üìä Total pages in PDF: ${o}`),console.log(`   ‚úÖ Pages processed immediately: ${r.length}`),console.log(`   ‚è≥ Pages will be processed when loaded: ${S}`),console.log("   üìã Processed page numbers:",r.map(s=>s.pageNumber).join(", ")),console.log("   ‚öôÔ∏è  Settings applied:",q),d(1),await new Promise(s=>requestAnimationFrame(s))}catch(a){console.error("‚ùå Error in Apply All:",a)}finally{await new Promise(a=>setTimeout(a,300)),bt(!1),Dt(!1),yt(0)}},ha=async()=>{nt(!0),We(0);try{et&&_&&!pt&&(Tt(),await new Promise(t=>setTimeout(t,50))),await ua()}catch(t){console.error("‚ùå Error applying changes:",t),nt(!1),We(0)}},ua=async()=>{const t={pageIndex:be,currentCanvas:xe.current,pages:[...H],originalPages:[...Y],settings:{...q},colorMode:E,pagesPerSheet:v,directPageEdit:P};console.log("‚ö° Processing edits with progress tracking...");const a=d=>{We(d)};try{await ma(t,a),Se(!1),nt(!1),We(0),t.directPageEdit&&g()}catch(d){console.error("‚ùå Error in save:",d),Se(!1),nt(!1),We(0),t.directPageEdit&&g()}},ma=async(t,a)=>{var S;const{pageIndex:d,currentCanvas:n,pages:o,originalPages:r,settings:m,colorMode:b,pagesPerSheet:D,directPageEdit:C}=t;if(a(.1),await new Promise(s=>requestAnimationFrame(s)),n&&o[d]){const s=document.createElement("canvas"),w=s.getContext("2d");s.width=n.width,s.height=n.height,w.drawImage(n,0,0);let x=[d];D===2&&((S=o[d])==null?void 0:S.isSheet)&&(x=[d*2,d*2+1].filter(f=>f<r.length));const i=r.map(f=>({...f})),j=x.length;let y=0;x.forEach(f=>{var ne,Re;const u=document.createElement("canvas"),I=u.getContext("2d"),$=r[f];u.width=$.width,u.height=$.height,I.fillStyle="white",I.fillRect(0,0,u.width,u.height),I.save(),I.translate(u.width/2,u.height/2),I.translate(m.offsetX,m.offsetY),m.rotation!==0&&I.rotate(m.rotation*Math.PI/180);const F=m.rotation%360,Z=F===90||F===270;let U;if(Z){const pe=u.width/$.height,ge=u.height/$.width;U=Math.min(pe,ge)}else{const pe=u.width/$.width,ge=u.height/$.height;U=Math.min(pe,ge)}const te=m.scale/100,le=U*te;let K,G,T;((ne=o[be])==null?void 0:ne.cropInfo)&&$.pageNumber===o[be].pageNumber?(K=$.canvas,G=$.canvas.width,T=$.canvas.height,console.log("‚úÇÔ∏è Using cropped canvas for save - crop is permanent")):(K=$.pristineOriginal||$.originalCanvas||$.canvas,G=$.width,T=$.height);const se=G*le,Ce=T*le;if(I.drawImage(K,-se/2,-Ce/2,se,Ce),I.restore(),b==="BW"){const pe=document.createElement("canvas");pe.width=u.width,pe.height=u.height;const ge=pe.getContext("2d");ge.filter="grayscale(100%)",ge.drawImage(u,0,0),I.clearRect(0,0,u.width,u.height),I.fillStyle="white",I.fillRect(0,0,u.width,u.height),I.drawImage(pe,0,0)}i[f]={...i[f],canvas:u,pristineOriginal:$.pristineOriginal||$.originalCanvas,originalCanvas:$.pristineOriginal||$.originalCanvas,width:$.width,height:$.height,thumbnail:u.toDataURL("image/jpeg",.4),edited:!0,editHistory:{...i[f].editHistory,rotation:m.rotation,scale:m.scale,offsetX:m.offsetX,offsetY:m.offsetY,cropArea:((Re=i[f].editHistory)==null?void 0:Re.cropArea)||null}},y++;const $e=.1+.6*y/j;a($e)}),a(.7),await new Promise(f=>requestAnimationFrame(f)),Q(i);const h=new Map;if(x.forEach(f=>{const u=i[f];u&&h.set(u.pageNumber,u)}),a(.75),await new Promise(f=>requestAnimationFrame(f)),D===2?(J(f=>f.map((u,I)=>{if(!u.isSheet){const G=h.get(u.pageNumber);if(G){const T=Ie(G.canvas,b);return{...G,canvas:T,thumbnail:T.toDataURL("image/jpeg",.4)}}return u}const $=u.containsPages[0],F=u.containsPages[1],Z=h.get($),U=F?h.get(F):null;if(!Z&&!U)return u;const te=Z||i.find(G=>G.pageNumber===$),le=U||(F?i.find(G=>G.pageNumber===F):null);if(!te||F&&!le)return console.log(`‚ö†Ô∏è Cannot regenerate sheet ${$}-${F}: missing page data, keeping existing sheet`),u;const K=Ie(te.canvas,b);if(le){const G=Ie(le.canvas,b),T=Rt(K,G,Be(ue));return{pageNumber:`${te.pageNumber}-${le.pageNumber}`,canvas:T,originalCanvas:T,thumbnail:T.toDataURL("image/jpeg",.4),width:T.width,height:T.height,isSheet:!0,containsPages:[te.pageNumber,le.pageNumber],edited:te.edited||le.edited}}else return{...te,canvas:K,thumbnail:K.toDataURL("image/jpeg",.6)}})),ee(f=>f.map(u=>{const I=h.get(u.pageNumber);return I?{...u,thumbnail:I.thumbnail||u.thumbnail,isLoaded:!0,edited:!0}:u}))):(J(f=>f.map(u=>{const I=h.get(u.pageNumber);if(I){const $=Ie(I.canvas,b);return{...I,canvas:$,thumbnail:$.toDataURL("image/jpeg",.6)}}return u})),ee(f=>f.map(u=>{const I=h.get(u.pageNumber);return I?{...u,thumbnail:I.thumbnail||u.thumbnail,isLoaded:!0,edited:!0}:u}))),a(1),await new Promise(f=>requestAnimationFrame(f)),C&&l){(async()=>{try{console.log(`üìÑ Creating updated PDF for direct page edit mode with ${V.length} total pages...`);const u=new Map;i.forEach(K=>{K.edited&&u.set(K.pageNumber,K)}),console.log(`üìù Found ${u.size} edited pages in loaded pages`);const I=Pe.current!==null;if(I&&console.log(`‚ö° "Apply All" was used - will apply settings to ALL ${V.length} pages`),u.size===0&&!I){console.log("‚úÖ No edits detected, returning original PDF"),l(N);return}const $=await N.arrayBuffer(),F=await Ot.load($);console.log("üîß Applying transformations (canvas for crop, metadata for others)");const Z=new Map,U=new Map;for(const[K,G]of u.entries()){const T=G.editHistory,O=T==null?void 0:T.cropArea;console.log(`üîç Page ${K} categorization:`,{hasCrop:!!(T!=null&&T.cropArea),hasRotation:!!(T!=null&&T.rotation),hasScale:!!(T!=null&&T.scale),needsRecomposition:O,willUse:O?"CANVAS (image)":"METADATA (vector)"}),O?Z.set(K,G):U.set(K,G)}if(I){const K=F.getPageCount(),G=Pe.current,{cropInfo:T}=G;console.log(`‚ö° Applying "Apply All" settings to ${K-u.size} unloaded pages...`);for(let O=1;O<=K;O++){if(u.has(O))continue;const se={pageNumber:O,editHistory:{...G.settings,cropArea:T||null}};T?Z.set(O,se):U.set(O,se)}console.log(`‚úÖ Added ${K-u.size} pages from "Apply All" settings`)}console.log(`üìä Recomposed pages (canvas): ${Z.size}, Metadata-only pages: ${U.size}`);for(const[K,G]of Z.entries()){const T=G.editHistory;console.log(`üìù Cropping page ${K}`);const O=K-1,se=F.getPage(O),{width:Ce,height:$e}=se.getSize(),ne=G.canvas;if(ne&&T.cropArea){const Re=T.cropArea.x*ne.width,pe=T.cropArea.y*ne.height,ge=T.cropArea.width*ne.width,Fe=T.cropArea.height*ne.height;console.log(`  ‚úÇÔ∏è Crop area on canvas: [${Re.toFixed(1)}, ${pe.toFixed(1)}, ${ge.toFixed(1)}√ó${Fe.toFixed(1)}]`);const fe=document.createElement("canvas"),Le=fe.getContext("2d");fe.width=ge,fe.height=Fe,Le.drawImage(ne,Re,pe,ge,Fe,0,0,ge,Fe);const lt=fe.toDataURL("image/png"),ct=Uint8Array.from(atob(lt.split(",")[1]),Qe=>Qe.charCodeAt(0)),qe=await F.embedPng(ct);F.removePage(O);const Ge=F.insertPage(O,[Ce,$e]),je=T.fitCropToPage||!1,ve=vt(Ce,$e,ge,Fe,je);Ge.drawImage(qe,{x:ve.drawX,y:$e-ve.drawY-ve.drawHeight,width:ve.drawWidth,height:ve.drawHeight}),console.log(`  ‚úÖ Page cropped and embedded centered at (${ve.drawX.toFixed(1)}, ${ve.drawY.toFixed(1)}) with size ${ve.drawWidth.toFixed(1)}√ó${ve.drawHeight.toFixed(1)}${je?" [FIT TO PAGE]":""}`)}}for(const[K,G]of U.entries()){const T=K-1;let O=F.getPage(T);const se=G.editHistory;if(!se)continue;const{width:Ce,height:$e}=O.getSize();console.log(`üìù Applying metadata transformations to page ${K}:`,{rotation:se.rotation,scale:se.scale,offset:[se.offsetX,se.offsetY]});const ne=se.rotation||0,Re=(se.scale||100)/100,pe=se.offsetX||0,ge=se.offsetY||0;if(ne!==0){console.log(`  ‚Üª Applying ${ne}¬∞ rotation by redrawing page`);const[Fe]=await F.embedPages([O]);let fe=Ce,Le=$e;const lt=F.getPages().indexOf(O);F.removePage(lt);const ct=F.insertPage(lt,[fe,Le]),qe=fe/2,Ge=Le/2;let je=1;(ne===90||ne===270||ne===-90||ne===-270)&&(je=Math.min(fe/Le,Le/fe));let ve=qe,Qe=Ge;(ne===90||ne===270||ne===-90)&&(ve=qe-Le*je/2,Qe=Ge-fe*je/2),ct.drawPage(Fe,{x:ve,y:Qe,width:fe*je,height:Le*je,rotate:{type:"degrees",angle:ne}}),console.log(`  ‚úÖ Page redrawn with ${ne}¬∞ rotation (scale: ${je.toFixed(3)}x)`),O=ct}if(Re!==1){const Fe=Ce/2,fe=$e/2;O.translateContent(-Fe,-fe),O.scaleContent(Re,Re),O.translateContent(Fe,fe),console.log(`  üîç Scaled content to ${Re}x`)}(pe!==0||ge!==0)&&(O.translateContent(pe,-ge),console.log(`  ‚ÜîÔ∏è Offset by [${pe}, ${-ge}]`))}console.log(`‚úÖ Export complete: ${Z.size} recomposed (canvas), ${U.size} metadata-only`);const te=await F.save(),le=new File([te],N.name,{type:"application/pdf"});console.log("‚úÖ PDF created successfully, saving..."),l(le)}catch(u){console.error("‚ùå Error creating updated PDF:",u),g()}})();return}const A={};x.forEach(f=>{const u=i[f];u&&u.edited&&(A[u.pageNumber]={thumbnail:u.thumbnail,edited:!0,canvas:u.canvas})}),console.log(`üì¢ Dispatching update for ${Object.keys(A).length} edited pages:`,Object.keys(A));const k=new CustomEvent("pdfEditorUpdate",{detail:{editedPages:A}});window.dispatchEvent(k)}},pa=async()=>{try{he(!0),console.log(`üìÑ Exporting PDF with ${V.length} total pages, ${Y.length} loaded`);const t=new Map;Y.forEach(C=>{C.edited&&C.editHistory&&t.set(C.pageNumber,C)}),console.log(`üìù Found ${t.size} edited pages in loaded pages`);const a=Pe.current!==null;if(a&&console.log(`‚ö° "Apply All" was used - will apply settings to ALL ${V.length} pages`),t.size===0&&!a){console.log("‚úÖ No edits detected, returning original PDF");const C=new CustomEvent("pdfEditorUpdate",{detail:{editedPages:{},finalPDF:N}});window.dispatchEvent(C),l(N);return}const d=await N.arrayBuffer(),n=await Ot.load(d);console.log("üîß Applying transformations (canvas for crop, metadata for others)");const o=new Map;for(const[C,S]of t.entries()){const s=S.editHistory,w=!!(s!=null&&s.cropArea),x=!!(s!=null&&s.rotation),c=(s==null?void 0:s.scale)&&(s==null?void 0:s.scale)!==100;console.log(`üîç Page ${C}:`,{hasCrop:w,hasRotation:x,hasScale:c,method:"VECTOR (transformation matrix + clipping)"}),o.set(C,S)}if(a){const C=n.getPageCount(),S=Pe.current,{cropInfo:s}=S;console.log(`‚ö° Applying "Apply All" settings to ${C-t.size} unloaded pages...`);for(let w=1;w<=C;w++){if(t.has(w))continue;const x={pageNumber:w,editHistory:{...S.settings,cropArea:s||null}};o.set(w,x)}console.log(`‚úÖ Added ${C-t.size} pages from "Apply All" settings`)}console.log(`üìä Total transformed pages: ${o.size} (all using vector methods)`);for(const[C,S]of o.entries()){const s=C-1,w=n.getPage(s),{width:x,height:c}=w.getSize(),i=S.editHistory;if(!i)continue;const j=!!i.cropArea,y=!!i.rotation,h=i.scale&&i.scale!==100;console.log(`üìù Processing page ${C}:`,{hasCrop:j,hasRotation:y,hasScale:h,method:"Vector-preserving (transformation matrix + clipping)"});const A=qt({width:x,height:c},{width:x,height:c},i),[k]=await n.embedPages([w]);n.removePage(s);const f=n.insertPage(s,[x,c]);f.drawRectangle({x:0,y:0,width:x,height:c,color:{type:"RGB",red:1,green:1,blue:1}}),f.pushOperators(Ca());const u=A.sourceRect.x,I=c-A.sourceRect.y-A.sourceRect.height,$=A.sourceRect.width,F=A.sourceRect.height,Z=(x-$)/2,U=(c-F)/2;if(f.pushOperators(gt(1,0,0,1,Z,U)),console.log(`  üìê Centering crop: offset by [${Z.toFixed(1)}, ${U.toFixed(1)}]`),y||h){const K=i.rotation||0,G=-K*Math.PI/180,T=Math.cos(G),O=Math.sin(G),se=A.finalScale,Ce=$/2,$e=F/2;f.pushOperators(gt(1,0,0,1,Ce,$e)),f.pushOperators(gt(se*T,se*O,-se*O,se*T,0,0)),f.pushOperators(gt(1,0,0,1,-Ce,-$e)),console.log(`  ‚Üª Applied rotation ${K}¬∞ and scale ${se.toFixed(3)}x around crop center`)}j&&(f.pushOperators($a(0,0),jt($,0),jt($,F),jt(0,F),ja(),Sa(),Aa()),console.log(`  ‚úÇÔ∏è Crop clip: [0, 0, ${$.toFixed(1)}√ó${F.toFixed(1)}]`));const te=-u,le=-I;f.drawPage(k,{x:te,y:le,width:x,height:c}),f.pushOperators(Ra()),console.log("  ‚úÖ Page transformed (vectors preserved)")}console.log(`‚úÖ Export complete: ${o.size} pages with vector-preserving transforms`);const r=await n.save(),m=new File([r],N.name,{type:"application/pdf"}),b={};Y.forEach(C=>{C.edited&&(b[C.pageNumber]={thumbnail:C.thumbnail,edited:!0,canvas:C.canvas})});const D=new CustomEvent("pdfEditorUpdate",{detail:{editedPages:b,finalPDF:m}});window.dispatchEvent(D),l(m)}catch(t){console.error("‚ùå Error exporting PDF:",t),console.error("Error message:",t.message),console.error("Error stack:",t.stack),console.error("Error name:",t.name),alert(`Error exporting PDF: ${t.message||t}`)}finally{he(!1)}};if(re)return e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-2xl mx-auto mb-4 flex items-center justify-center",children:e.jsx(dt,{className:"w-8 h-8 text-red-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Error Loading PDF"}),e.jsx("p",{className:"text-gray-600 mb-6",children:re}),e.jsx("button",{onClick:g,className:"px-6 py-3 bg-gray-600 text-white rounded-xl hover:bg-gray-700 transition-all duration-200",children:"Close Editor"})]});if(!Ee&&!P)return e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-3 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6 gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-blue-600 rounded-xl flex items-center justify-center",children:e.jsx(Ct,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg sm:text-2xl font-bold text-gray-900",children:"PDF Editor"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:H.length>0?`${(ae==null?void 0:ae.numPages)||V.length} pages`:"Loading..."})]})]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 w-full sm:w-auto",children:[e.jsx("button",{onClick:pa,disabled:oe,className:"flex-1 sm:flex-initial flex items-center justify-center gap-1 sm:gap-2 px-4 sm:px-6 py-2 sm:py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50 text-xs sm:text-sm",children:oe?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 sm:w-4 sm:h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(St,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"Save"]})}),e.jsxs("button",{onClick:g,className:"flex items-center justify-center gap-1 sm:gap-2 px-3 sm:px-6 py-2 sm:py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-xs sm:text-sm",children:[e.jsx(dt,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Cancel"})]})]})]}),e.jsx(Ha,{loadingStage:ie,loadedCount:V.filter(t=>t.isLoaded).length,totalPages:V.length}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-2 sm:gap-3",children:V.map((t,a)=>{const d=W&&X.includes(t.pageNumber);return e.jsxs("div",{ref:n=>_e.current[t.pageNumber]=n,"data-page-number":t.pageNumber,className:`relative bg-white border-2 rounded-lg p-2 hover:shadow-lg transition-all overflow-hidden ${d?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-400"}`,children:[W&&!t.isSheet&&e.jsx("div",{className:"absolute top-1 left-1 z-10",children:e.jsx("button",{onClick:n=>{n.stopPropagation(),W(t.pageNumber)},className:"bg-white rounded shadow-sm p-1 hover:bg-gray-50",children:d?e.jsx(wa,{className:"w-4 h-4 text-blue-600"}):e.jsx(ba,{className:"w-4 h-4 text-gray-400"})})}),e.jsxs("div",{className:"relative mb-1.5 cursor-pointer",onClick:()=>{W&&!t.isSheet&&W(t.pageNumber)},children:[e.jsx("div",{className:"aspect-[3/4] bg-gray-50 rounded overflow-hidden border border-gray-200",children:(t.isLoaded||t.thumbnail)&&t.thumbnail?e.jsx("img",{src:t.thumbnail,alt:`Page ${t.pageNumber}`,className:"w-full h-full object-contain p-1 animate-fade-in"}):e.jsx(za,{width:"100%",height:"100%"})}),t.edited&&e.jsx("div",{className:"absolute top-1 right-1 bg-green-500 text-white px-2 py-0.5 rounded text-[10px] font-semibold",children:"Edited"})]}),e.jsx("div",{className:"text-center mb-1.5",children:e.jsx("h3",{className:"font-semibold text-gray-800 text-xs",children:t.isSheet?`Pages ${t.pageNumber}`:`Page ${t.pageNumber}`})}),e.jsxs("button",{onClick:()=>{if(!t.isLoaded&&!t.isSheet)He(t.pageNumber).then(()=>{const n=H.findIndex(o=>o.pageNumber===t.pageNumber);n!==-1&&Xt(n)});else{const n=H.findIndex(o=>o.pageNumber===t.pageNumber);n!==-1&&Xt(n)}},disabled:t.isLoading,className:"w-full flex items-center justify-center gap-1 px-2 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors text-xs font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Ht,{className:"w-3 h-3"}),t.isLoading?"Loading...":"Edit"]})]},t.pageNumber)})})]});const rt=H[be];return e.jsxs("div",{className:"fixed inset-0 bg-white z-50 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 text-white px-2 py-2 sm:px-4 sm:py-3 flex items-center justify-between flex-shrink-0 shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(Ht,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsxs("h2",{className:"text-sm sm:text-base font-bold truncate",children:["Page ",rt==null?void 0:rt.pageNumber]}),e.jsx("div",{className:`px-2 py-0.5 rounded-full text-xs font-bold ${E==="Color"?"bg-pink-500 text-white":"bg-white/25 text-white"}`,children:E==="Color"?"üé®":"‚ö´"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsxs("div",{className:"hidden sm:flex items-center gap-1 bg-white/15 rounded-md px-2 py-1",children:[e.jsx("button",{onClick:()=>at(Math.max(.5,de-.25)),className:"p-1 hover:bg-white/20 rounded transition-colors",children:e.jsx(ya,{className:"w-3 h-3"})}),e.jsxs("span",{className:"text-xs font-bold px-1",children:[Math.round(de*100),"%"]}),e.jsx("button",{onClick:()=>at(Math.min(2,de+.25)),className:"p-1 hover:bg-white/20 rounded transition-colors",children:e.jsx(va,{className:"w-3 h-3"})})]}),e.jsx("button",{onClick:ia,className:"p-1.5 bg-white/15 hover:bg-white/25 rounded transition-colors",title:"Close",children:e.jsx(dt,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"flex-1 bg-gray-100 flex items-center justify-center relative overflow-auto",children:e.jsx("div",{ref:ta,className:"image-container relative w-full h-full flex items-center justify-center",style:{transform:`scale(${de})`,transformOrigin:"center center"},onMouseMove:kt,onMouseUp:Nt,onMouseLeave:Nt,onTouchMove:t=>{if(pt){t.preventDefault();const a=t.touches[0];kt({clientX:a.clientX,clientY:a.clientY,preventDefault:()=>{}})}},onTouchEnd:Nt,children:rt&&e.jsxs(e.Fragment,{children:[e.jsx("canvas",{ref:xe,className:"max-w-full max-h-full object-contain"}),ft&&e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-30",style:{backgroundImage:`
                        linear-gradient(rgba(59, 130, 246, 0.3) 1px, transparent 1px),
                        linear-gradient(90deg, rgba(59, 130, 246, 0.3) 1px, transparent 1px)
                      `,backgroundSize:"20px 20px"}}),et&&_&&xe.current&&(()=>{const t=xe.current,a=t.getBoundingClientRect(),n=t.closest(".image-container").getBoundingClientRect(),o=a.width/de,r=a.height/de,m=t.width,b=t.height,D=o/m,C=r/b,S=_.x*D,s=_.y*C,w=_.width*D,x=_.height*C,c=(n.width/de-o)/2,i=(n.height/de-r)/2;return console.log("üé® Crop overlay (CANVAS PIXEL SPACE):",{canvasPixels:`(${_.x.toFixed(1)}, ${_.y.toFixed(1)})`,canvasSize:`${_.width.toFixed(1)}√ó${_.height.toFixed(1)}`,domPos:`(${S.toFixed(1)}, ${s.toFixed(1)})`,domSize:`${w.toFixed(1)}√ó${x.toFixed(1)}`,canvasPosition:`(${c.toFixed(1)}, ${i.toFixed(1)})`}),e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:e.jsxs("div",{className:"absolute border-2 border-blue-500 bg-blue-500/10 backdrop-blur-sm pointer-events-auto",style:{left:c+S,top:i+s,width:w,height:x,transition:"none"},children:[e.jsx("div",{className:"absolute inset-0 border-2 border-dashed border-white/80 rounded-sm"}),e.jsxs("div",{className:"absolute inset-0 opacity-40",children:[e.jsx("div",{className:"absolute left-1/3 top-0 bottom-0 w-px bg-white"}),e.jsx("div",{className:"absolute left-2/3 top-0 bottom-0 w-px bg-white"}),e.jsx("div",{className:"absolute top-1/3 left-0 right-0 h-px bg-white"}),e.jsx("div",{className:"absolute top-2/3 left-0 right-0 h-px bg-white"})]}),[{handle:"nw",position:{left:-10,top:-10},cursor:"nw-resize"},{handle:"ne",position:{right:-10,top:-10},cursor:"ne-resize"},{handle:"sw",position:{left:-10,bottom:-10},cursor:"sw-resize"},{handle:"se",position:{right:-10,bottom:-10},cursor:"se-resize"}].map(({handle:j,position:y,cursor:h})=>e.jsx("div",{className:`absolute w-8 h-8 sm:w-7 sm:h-7 bg-gradient-to-br from-blue-400 to-blue-600 border-3 border-white rounded-full shadow-lg cursor-${h} hover:scale-110 active:scale-125 transition-all duration-150 hover:shadow-xl z-10 pointer-events-auto touch-none`,style:y,onMouseDown:A=>it(A,j),onTouchStart:A=>{A.preventDefault();const k=A.touches[0];it({clientX:k.clientX,clientY:k.clientY,preventDefault:()=>{},stopPropagation:()=>{}},j)}},j)),e.jsx("div",{className:"absolute w-10 h-10 sm:w-9 sm:h-9 bg-gradient-to-br from-blue-500 to-purple-600 border-3 border-white rounded-full shadow-lg cursor-move hover:scale-110 active:scale-125 transition-all duration-150 hover:shadow-xl flex items-center justify-center z-10 pointer-events-auto touch-none",style:{left:"50%",top:"50%",transform:"translate(-50%, -50%)"},onMouseDown:j=>it(j,"center"),onTouchStart:j=>{j.preventDefault();const y=j.touches[0];it({clientX:y.clientX,clientY:y.clientY,preventDefault:()=>{},stopPropagation:()=>{}},"center")},children:e.jsx(Ea,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"absolute -top-8 left-0 bg-gradient-to-r from-blue-600 to-purple-600 text-white px-2 py-1 rounded text-xs font-medium shadow-lg pointer-events-none",children:["üìê ",Math.round(_.width)," √ó ",Math.round(_.height)]})]})})})()]})})}),e.jsxs("div",{className:"bg-gray-50 border-t border-gray-200 p-2 flex-shrink-0",children:[e.jsx("div",{className:"flex gap-1 mb-2",children:[{id:"pagesize",label:"Size",icon:$t},{id:"crop",label:"Crop",icon:Da},{id:"transform",label:"Transform",icon:Wt}].map(t=>e.jsxs("button",{onClick:()=>xt(t.id),className:`flex items-center justify-center gap-1 px-2 py-1.5 rounded-lg font-semibold transition-colors text-xs flex-1 ${ze===t.id?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300"}`,children:[e.jsx(t.icon,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:t.label})]},t.id))}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[ze==="pagesize"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white border border-gray-200 rounded-lg p-2 shadow-sm flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($t,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-xs font-medium whitespace-nowrap",children:"Page Size:"})]}),e.jsx(Ma,{value:wt,onChange:Kt,options:Object.entries(Na).map(([t,a])=>({value:t,label:a.displayName})),fullWidth:!1,className:"min-w-[180px]"})]}),e.jsxs("button",{onClick:()=>{Ze(wt),L&&L(wt)},className:"flex items-center gap-1 px-3 py-1.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors text-xs font-semibold",children:[e.jsx(Ut,{className:"w-3.5 h-3.5"}),"Apply"]})]}),ze==="crop"&&e.jsx(e.Fragment,{children:v===2&&((zt=H[be])!=null&&zt.isSheet)?e.jsx("div",{className:"w-full bg-yellow-50 border border-yellow-300 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ta,{className:"w-4 h-4 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-xs text-yellow-800",children:[e.jsx("p",{className:"font-semibold mb-1",children:"‚ö†Ô∏è Crop Cannot Be Applied to N-up Sheets"}),e.jsx("p",{className:"mt-1 font-medium",children:"Recommended: Switch to individual pages (remove N-up), apply crop to each page separately, then re-enable N-up mode."})]})]})}):e.jsxs(e.Fragment,{children:[et?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("button",{onClick:Tt,className:"flex items-center gap-1 px-3 py-1.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors text-xs font-semibold",children:[e.jsx(Ut,{className:"w-3.5 h-3.5"}),"Apply"]}),e.jsxs("button",{onClick:()=>{Oe(!1),Te(null)},className:"flex items-center gap-1 px-3 py-1.5 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors text-xs font-semibold",children:[e.jsx(dt,{className:"w-3.5 h-3.5"}),"Cancel"]})]}):e.jsxs("button",{onClick:la,className:"flex items-center gap-1 px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors text-xs font-semibold",children:[e.jsx(La,{className:"w-3.5 h-3.5"}),"Start"]}),e.jsxs("button",{onClick:()=>_t(!ft),className:`flex items-center gap-1 px-3 py-1.5 rounded-lg transition-colors text-xs font-semibold ${ft?"bg-blue-600 text-white":"bg-white text-gray-700 border border-gray-300"}`,children:[e.jsx(Ia,{className:"w-3.5 h-3.5"}),"Grid"]}),e.jsxs("label",{className:"flex items-center gap-2 px-3 py-1.5 bg-white border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:q.fitCropToPage||!1,onChange:t=>Ae(a=>({...a,fitCropToPage:t.target.checked})),className:"w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs font-semibold text-gray-700",children:"Fit to Page"})]})]})}),ze==="transform"&&e.jsxs("div",{className:"flex flex-col gap-2.5 w-full",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Ae(t=>({...t,rotation:(t.rotation-90+360)%360})),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",title:"Rotate Left",children:e.jsx(Pa,{className:"w-4 h-4 text-gray-700"})}),e.jsx("button",{onClick:()=>Ae(t=>({...t,rotation:(t.rotation+90)%360})),className:"p-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",title:"Rotate Right",children:e.jsx(Wt,{className:"w-4 h-4 text-gray-700"})}),e.jsxs("div",{className:"px-3 py-1.5 bg-blue-600 text-white rounded-lg text-xs font-medium",children:[q.rotation,"¬∞"]}),e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),e.jsxs("button",{onClick:ca,className:"flex items-center gap-1.5 px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors text-xs font-medium",children:[e.jsx(Xa,{className:"w-3.5 h-3.5"}),"Reset"]}),e.jsxs("button",{onClick:da,disabled:De,className:`relative flex items-center gap-1.5 px-3 py-1.5 text-white rounded-lg text-xs font-medium ml-auto overflow-hidden ${De?"bg-violet-600 cursor-wait":"bg-violet-600 hover:bg-violet-700 transition-colors"}`,children:[De&&e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute top-0 left-0 bottom-0 bg-white/40 transition-all duration-75 ease-linear",style:{width:`${Mt*100}%`}})}),e.jsxs("div",{className:"relative flex items-center gap-1.5 z-10",children:[e.jsx(Ct,{className:"w-3.5 h-3.5"}),De?"Applying...":"Apply to All"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($t,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),e.jsx("span",{className:"text-xs text-gray-600 font-medium min-w-[36px]",children:"Scale"}),e.jsx("input",{type:"range",min:"10",max:"700",step:"5",value:mt,onChange:t=>{const a=parseInt(t.target.value);Je(a),Ae(d=>({...d,scale:a}))},className:"flex-1 h-1.5"}),e.jsxs("span",{className:"text-xs text-gray-700 font-medium min-w-[42px] text-right",children:[mt,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ya,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),e.jsx("span",{className:"text-xs text-gray-600 font-medium min-w-[36px]",children:"Horiz"}),e.jsx("input",{type:"range",min:"-300",max:"300",value:q.offsetX,onChange:t=>Ae(a=>({...a,offsetX:parseInt(t.target.value)})),className:"flex-1 h-1.5"}),e.jsxs("span",{className:"text-xs text-gray-700 font-medium min-w-[42px] text-right",children:[q.offsetX,"px"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ka,{className:"w-4 h-4 text-gray-600 flex-shrink-0"}),e.jsx("span",{className:"text-xs text-gray-600 font-medium min-w-[36px]",children:"Vert"}),e.jsx("input",{type:"range",min:"-300",max:"300",value:q.offsetY,onChange:t=>Ae(a=>({...a,offsetY:parseInt(t.target.value)})),className:"flex-1 h-1.5"}),e.jsxs("span",{className:"text-xs text-gray-700 font-medium min-w-[42px] text-right",children:[q.offsetY,"px"]}),e.jsx("button",{onClick:()=>Ae(t=>({...t,offsetX:0,offsetY:0})),className:"px-2.5 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors text-xs font-medium",title:"Center content",children:"Center"})]})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("button",{onClick:ha,disabled:st,className:`relative w-full flex items-center justify-center gap-2 px-4 py-2 rounded-lg transition-all text-xs font-medium overflow-hidden ${st?"bg-violet-600 cursor-wait":"bg-violet-600 hover:bg-violet-700 hover:shadow-lg"} text-white`,children:[st&&e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute top-0 left-0 bottom-0 bg-white/40 transition-all duration-75 ease-linear",style:{width:`${ea*100}%`}})}),e.jsx("div",{className:"relative flex items-center gap-2 z-10",children:st?e.jsxs(e.Fragment,{children:[e.jsx(St,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"Applying Changes..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(St,{className:"w-3.5 h-3.5"}),P?"Save & Close":"Apply Changes"]})})]})})]}),Jt&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[70] flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full overflow-hidden animate-scale-in",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(Ct,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:"Apply to All Pages"}),e.jsx("p",{className:"text-blue-100 text-sm",children:"Confirm your action"})]})]})}),e.jsxs("div",{className:"px-6 py-5",children:[e.jsxs("p",{className:"text-gray-700 text-sm leading-relaxed mb-1",children:["Apply current ",e.jsx("span",{className:"font-semibold text-gray-900",children:ze==="color"?"color adjustments":ze==="transform"?"transform settings":"settings"})," to all pages in the document?"]}),e.jsxs("p",{className:"text-gray-500 text-xs mt-2",children:["‚ö° ",e.jsx("strong",{children:"Instant operation"})," - applies to loaded pages immediately. Unloaded pages will get these settings when viewed."]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>bt(!1),disabled:De,className:"px-5 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-all duration-200 hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsxs("button",{onClick:ga,disabled:De,className:`relative px-5 py-2.5 text-sm font-medium text-white rounded-lg transition-all duration-200 shadow-md overflow-hidden ${De?"bg-blue-600 cursor-wait":"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 hover:shadow-lg"}`,children:[De&&e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute top-0 left-0 bottom-0 bg-white/30",style:{width:`${Mt*100}%`}})}),e.jsx("span",{className:"relative z-10",children:De?"Applying to All...":"Apply to All"})]})]})]})})]})};export{Za as default};
